@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import react-resizable CSS */
@import '~react-resizable/css/styles.css';

/* AI Component Selection Styles */
.ai-component {
  cursor: pointer;
}

/* Disable pointer events on component content but allow control buttons */
.ai-component .ai-live-preview * {
  pointer-events: none !important;
  user-select: none !important;
}

/* Exception: Allow buttons and interactive elements in the preview to work */
.ai-component .ai-live-preview button,
.ai-component .ai-live-preview input,
.ai-component .ai-live-preview textarea,
.ai-component .ai-live-preview select,
.ai-component .ai-live-preview [role="button"],
.ai-component .ai-live-preview [onclick] {
  pointer-events: auto !important;
  cursor: pointer !important;
}

/* Allow control buttons and headers to be clickable */
.ai-component button,
.ai-component [role="button"],
.ai-component .bg-gray-50,
.ai-component .bg-gray-100,
.ai-component .ai-live-preview-container,
.ai-component .ai-live-preview-container button,
.ai-component .ai-live-preview-container [role="button"] {
  pointer-events: auto !important;
  cursor: pointer !important;
}

.ai-component .ai-live-preview-container {
  pointer-events: auto !important;
}

.ai-component .ai-live-preview {
  pointer-events: none !important;
}

/* Ensure AI component container is clickable */
.ai-component[data-ai-component="true"] {
  pointer-events: auto !important;
  cursor: pointer;
}

body {
  font-family: Arial, Helvetica, sans-serif;
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 240 10% 3.9%;
    --card: 0 0% 100%;
    --card-foreground: 240 10% 3.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 240 10% 3.9%;
    --primary: 240 5.9% 10%;
    --primary-foreground: 0 0% 98%;
    --secondary: 240 4.8% 95.9%;
    --secondary-foreground: 240 5.9% 10%;
    --muted: 240 4.8% 95.9%;
    --muted-foreground: 240 3.8% 46.1%;
    --accent: 240 4.8% 95.9%;
    --accent-foreground: 240 5.9% 10%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 5.9% 90%;
    --input: 240 5.9% 90%;
    --ring: 240 10% 3.9%;
    --chart-1: 12 76% 61%;
    --chart-2: 173 58% 39%;
    --chart-3: 197 37% 24%;
    --chart-4: 43 74% 66%;
    --chart-5: 27 87% 67%;
    --radius: 0.5rem;
    --sidebar-background: 0 0% 98%;
    --sidebar-foreground: 240 5.3% 26.1%;
    --sidebar-primary: 240 5.9% 10%;
    --sidebar-primary-foreground: 0 0% 98%;
    --sidebar-accent: 240 4.8% 95.9%;
    --sidebar-accent-foreground: 240 5.9% 10%;
    --sidebar-border: 220 13% 91%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
  .dark {
    --background: 240 10% 3.9%;
    --foreground: 0 0% 98%;
    --card: 240 10% 3.9%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 3.9%;
    --popover-foreground: 0 0% 98%;
    --primary: 0 0% 98%;
    --primary-foreground: 240 5.9% 10%;
    --secondary: 240 3.7% 15.9%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 3.7% 15.9%;
    --muted-foreground: 240 5% 64.9%;
    --accent: 240 3.7% 15.9%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 3.7% 15.9%;
    --input: 240 3.7% 15.9%;
    --ring: 240 4.9% 83.9%;
    --chart-1: 220 70% 50%;
    --chart-2: 160 60% 45%;
    --chart-3: 30 80% 55%;
    --chart-4: 280 65% 60%;
    --chart-5: 340 75% 55%;
    --sidebar-background: 240 5.9% 10%;
    --sidebar-foreground: 240 4.8% 95.9%;
    --sidebar-primary: 224.3 76.3% 48%;
    --sidebar-primary-foreground: 0 0% 100%;
    --sidebar-accent: 240 3.7% 15.9%;
    --sidebar-accent-foreground: 240 4.8% 95.9%;
    --sidebar-border: 240 3.7% 15.9%;
    --sidebar-ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Add styling for AI-generated components */
.ai-live-preview {
  width: 100%;
  min-height: 50px;
}

.ai-component {
  transition: all 0.2s ease;
}

.ai-component:hover {
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

/* Ensure react-live components have proper spacing */
.ai-live-preview button {
  margin: 0.25rem;
}

.ai-live-preview input,
.ai-live-preview textarea {
  margin: 0.25rem 0;
}

.ai-live-preview label {
  display: block;
  margin-top: 0.5rem;
}

/* AI Loading State Styles */
.ai-loading {
  @apply relative;
}

.ai-loading::before {
  content: '';
  @apply absolute inset-0 bg-blue-50 border-2 border-blue-200 rounded opacity-75;
}

.ai-loading button,
.ai-loading[role="button"] {
  @apply opacity-50 cursor-not-allowed;
}

/* React Resizable Handle Overrides */
.react-resizable-handle {
  z-index: 1000 !important;
  opacity: 0.7;
  transition: opacity 0.2s ease;
}

.react-resizable-handle:hover {
  opacity: 1;
}

/* Make resize handles more visible */
.react-resizable-handle-se {
  bottom: -5px !important;
  right: -5px !important;
  width: 10px !important;
  height: 10px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 2px !important;
}

.react-resizable-handle-s {
  bottom: -5px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  width: 20px !important;
  height: 6px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 3px !important;
}

.react-resizable-handle-e {
  right: -5px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 6px !important;
  height: 20px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 3px !important;
}

.react-resizable-handle-ne {
  top: -5px !important;
  right: -5px !important;
  width: 10px !important;
  height: 10px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 2px !important;
}

.react-resizable-handle-n {
  top: -5px !important;
  left: 50% !important;
  transform: translateX(-50%) !important;
  width: 20px !important;
  height: 6px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 3px !important;
}

.react-resizable-handle-w {
  left: -5px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 6px !important;
  height: 20px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 3px !important;
}

.react-resizable-handle-sw {
  bottom: -5px !important;
  left: -5px !important;
  width: 10px !important;
  height: 10px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 2px !important;
}

.react-resizable-handle-nw {
  top: -5px !important;
  left: -5px !important;
  width: 10px !important;
  height: 10px !important;
  background: #3b82f6 !important;
  border: 1px solid white !important;
  border-radius: 2px !important;
}

/* Ensure resizable components have proper positioning context */
.react-resizable {
  position: relative !important;
}

/* Loading state for output components */
.loading {
  @apply relative;
}

.loading::after {
  content: '';
  @apply absolute inset-0 bg-gray-100 opacity-50 rounded;
}

.loading::before {
  content: 'Processing...';
  @apply absolute inset-0 flex items-center justify-center text-gray-600 font-medium z-10;
}

/* Enhanced button loading states */
.ai-loading button:disabled {
  @apply transform scale-95 transition-transform duration-200;
}

/* Loading overlay for better visibility */
.ai-loading::after {
  content: '';
  @apply absolute inset-0 bg-blue-100 bg-opacity-20 rounded pointer-events-none;
}

/* Pulse animation for loading state */
@keyframes ai-pulse {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.5;
  }
}

.ai-loading {
  animation: ai-pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

/* MiniMap Styles */
.minimap-container {
  @apply backdrop-blur-sm bg-white/95 border border-gray-200/80 shadow-xl;
  position: absolute;
  bottom: 8rem; /* Adjusted to match bottom-32 (128px) */
  left: 1rem; /* Changed from right to left positioning */
  z-index: 9998;
  /* Enhanced UI friendliness */
  backdrop-filter: blur(12px);
  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  /* Ensure proper sizing and containment */
  box-sizing: border-box;
  min-width: 174px; /* 150px + 24px padding */
  min-height: 174px;
}

.minimap-container:hover {
  @apply bg-white/100 border-gray-300/80;
  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
  transform: translateY(-2px);
}

.minimap-canvas {
  @apply transition-all duration-200 ease-in-out;
  /* Ensure canvas background covers entire area */
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}

.minimap-frame {
  @apply transition-all duration-150 ease-out;
  /* Enhanced frame visibility */
  border-radius: 2px;
  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

.minimap-frame:hover {
  @apply border-blue-600 bg-blue-200 bg-opacity-50;
  transform: scale(1.05);
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
}

.minimap-viewport {
  @apply transition-all duration-100 ease-out;
}

.minimap-component {
  @apply transition-all duration-150 ease-out;
}

.minimap-component:hover {
  @apply bg-gray-800 scale-150;
}

/* Responsive MiniMap */
@media (max-width: 768px) {
  .minimap-container {
    bottom: 2rem; /* Adjusted for mobile */
    left: 0.5rem; /* Changed from right to left */
    transform: scale(0.8); /* Make it smaller on mobile */
    transform-origin: bottom left;
  }
  
  .minimap-container .minimap-canvas {
    @apply w-32 h-32;
  }
}

@media (max-width: 480px) {
  .minimap-container {
    bottom: 1rem;
    left: 0.25rem;
    transform: scale(0.7); /* Even smaller on very small screens */
  }
  
  .minimap-container .minimap-canvas {
    @apply w-24 h-24;
  }
}

/* MiniMap animations */
@keyframes minimap-fade-in {
  from {
    opacity: 0;
    transform: translateY(10px) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translateY(0) scale(1);
  }
}

.minimap-container {
  animation: minimap-fade-in 0.3s ease-out;
}
